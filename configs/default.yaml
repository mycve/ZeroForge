# ============================================================================
# ZeroForge - 中国象棋 Gumbel MuZero 配置
# 适配: 8 GPU 训练
# ============================================================================

seed: 42

# ============================================================================
# 网络
# ============================================================================
network:
  # 隐藏层维度: 256 是性价比最高的选择
  hidden_dim: 256
  
  # 网络深度（ConvNeXt blocks）
  repr_blocks: 8    # Representation: 稍微减少，加快自对弈
  dyn_blocks: 4     # Dynamics
  pred_blocks: 4    # Prediction
  
  # 价值/奖励: 使用标量输出（简单高效）
  # 如果训练不稳定可以改成分类分布 (如 301)
  value_support_size: 0
  reward_support_size: 0

# ============================================================================
# MCTS
# ============================================================================
mcts:
  # MCTS 模拟次数
  num_simulations: 120
  # 每步考虑的最大动作数
  max_num_considered_actions: 32
  discount: 1.0
  
  # 温度采样：平衡探索与利用
  # 前 N 步用高温度探索（开局多样性）
  # 之后用 argmax 贪婪（中后期求胜）
  temperature: 1.5
  # 前 30 步随机探索，之后贪婪
  temp_threshold_steps: 30

# ============================================================================
# 训练
# ============================================================================
training:
  num_training_steps: 10000000
  
  # 8卡配置: batch_size 和 learning_rate 成比例
  # 每卡 batch = 1024 / 8 = 128
  batch_size: 1024
  # 降低学习率，防止策略崩溃
  learning_rate: 0.0002
  
  value_loss_weight: 1.0

# ============================================================================
# 自我对弈
# ============================================================================
self_play:
  # 8卡: 2048 = 8×256 (每卡256个并行游戏)
  # 更多并行 = 更多样本 = 训练更快
  num_parallel_games: 1024
  # 单局最大步数（象棋通常 100-200 步结束）
  max_steps: 200

# ============================================================================
# 评估
# ============================================================================
evaluation:
  # 每 2000 步评估一次（约 10 轮）
  eval_interval: 2000
  # 评估对局数
  num_games: 100

# ============================================================================
# 日志
# ============================================================================
logging:
  log_dir: "logs"
  # 每轮打印一次（约 400 步）
  console_interval: 400
  tensorboard_interval: 400

# ============================================================================
# 检查点
# ============================================================================
checkpoint:
  checkpoint_dir: "checkpoints"
  # 每 2000 步保存（约 5 轮）
  save_interval: 2000
  max_to_keep: 10
